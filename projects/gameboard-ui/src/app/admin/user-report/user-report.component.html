<!-- Copyright 2021 Carnegie Mellon University. All Rights Reserved. -->
<!-- Released under a MIT (SEI)-style license. See LICENSE.md in the project root for license information. -->

<a class="btn btn-link" routerLink="../">
  <fa-icon [icon]="faArrowLeft"></fa-icon>
  <span>Back</span>
</a>

<h4>User Reports</h4>

<div class="container table-dark border mb-4">
  <div class="row">
    <div class="col-8 p-2">
    </div>
    <div class="col-2 p-2 font-weight-bold" *ngIf="users">
      <div>
        <button class="btn btn-outline-info btn-sm mx-1" (click)="downloadUserDetailsReport()">Export User Report to CSV</button>
      </div>
    </div>
    <div class="col-2 p-2 font-weight-bold" *ngIf="players">
      <div>
        <button class="btn btn-outline-info btn-sm mx-1" (click)="downloadPlayerDetailsReport()">Export Player Report to CSV</button>
      </div>
    </div>
  </div>
</div>

<h5 class="pt-5 border-top">Users</h5>
<div class="container" pt-4 *ngIf="users; else loading">
  <div class="row border-top p-3">
    <div class="col-6 font-weight-bold">Category</div>
    <div class="col-6 font-weight-bold">Total</div>
  </div>
  <div class="row border-top p-3">
    <div class="col-6">Users Enrolled</div>
    <div class="col-6">{{users.enrolledUserCount}}</div>
  </div>
  <div class="row border-top p-3">
    <div class="col-6">Users Not Enrolled</div>
    <div class="col-6">{{users.unenrolledUserCount}}</div>
  </div>
  <div class="row border-top p-3">
    <div class="col-6">Total User Count</div>
    <div class="col-6">{{totalUserCount}}</div>
  </div>
</div>

<h5 class="pt-5">Players</h5>
<div class="container pt-4" *ngIf="players; else loading">
  <div class="row border-top p-3">
    <div class="col-6 font-weight-bold">Game</div>
    <div class="col-3 font-weight-bold">Player Count</div>
    <div class="col-3 font-weight-bold">Players with Sessions Count</div>
  </div>
  <div class="row border-top p-3" *ngFor="let p of players.stats">
    <div class="col-6">{{p.gameName}}</div>
    <div class="col-3">{{p.playerCount}}</div>  
    <div class="col-3">{{p.sessionPlayerCount}}</div>
  </div>
</div>

<ng-template #loading>
  <div class="text-center">
    <app-spinner></app-spinner>
  </div>
</ng-template>
